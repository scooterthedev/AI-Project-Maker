<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Maker</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <script src="/script.js" defer></script>
    <style>
        .typing-bar {
            display: inline-block;
            width: 20px; /* Width of the typing indicator */
            height: 1em; /* Height of the typing indicator */
            background-color: white; /* Color of the typing indicator */
            animation: blink-caret 1s step-end infinite;
        }

        @keyframes blink-caret {
            50% {
                opacity: 0;
            }
        }

        .big-text {
            color: #ffffff;
            font-size: 20px; /* Adjust size as needed */
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <a href="/login" class="login-btn">Login</a>
        <a href="/get-started" class="signup-btn">Sign Up</a>
        <div id="login-btn" style="display:none;">
            <button onclick="login()">Log In</button>
        </div>
    </div>

    <div class="menu-container">
        <div class="menu">
            <a href="#">Home</a>
            <a href="#">Projects</a>
            <a href="#">Pricing</a>
            <a href="#">Contact</a>
        </div>
    </div>

    <div class="grid"></div>

    <div class="additional-text">
        <div class="big-text">
            Welcome To
            <span class="bold-text">Project Maker</span>
        </div>
        <div class="subtitle">
            An All-In-One Project Creation Tool<br>
            For <span id="typing-text"></span><span class="typing-bar"></span>
        </div>
        <!-- "Get Started" button -->
        <a href="/get-started" class="get-started-btn">Get Started</a>
    </div>

    <script>
              document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.hash.substring(1));
            const accessToken = urlParams.get('access_token');

            if (accessToken) {
                try {
                    // Validate token on server or process it as needed
                    // For demonstration purposes, assume token is valid
                    // You should verify the token with Supabase or your server
                    // and handle errors appropriately.

                    // Display "Logged in!" popup
                    alert('Logged in!');

                    // Save the access token in a cookie
                    document.cookie = `accessToken=${accessToken}; max-age=86400; path=/`;


                    // Eventually: Redirect user to /app
                } catch (error) {
                    console.error('Error processing token:', error);
                    alert('Error processing token');
                }
            }
        });


        // Typing effect for multiple words
        const typingElement = document.getElementById('typing-text');
        const words = ['Coders', 'Architects', 'Enthusiast'];
        let currentWordIndex = 0;
        let currentCharIndex = 0;
        let isTypingForward = true;

        function typeText() {
            const currentWord = words[currentWordIndex];

            if (isTypingForward) {
                if (currentCharIndex < currentWord.length) {
                    typingElement.textContent += currentWord.charAt(currentCharIndex);
                    currentCharIndex++;
                    setTimeout(typeText, 200); // Adjust typing speed (milliseconds)
                } else {
                    isTypingForward = false;
                    setTimeout(typeText, 1000); // Pause before typing backwards (milliseconds)
                }
            } else {
                if (currentCharIndex >= 0) {
                    typingElement.textContent = currentWord.substring(0, currentCharIndex);
                    currentCharIndex--;
                    setTimeout(typeText, 100); // Adjust typing speed for backwards typing (milliseconds)
                } else {
                    isTypingForward = true;
                    currentWordIndex = (currentWordIndex + 1) % words.length; // Move to next word
                    setTimeout(typeText, 1000); // Pause before typing next word (milliseconds)
                }
            }
        }

        typeText(); // Start typing animation

    </script>
</body>
</html>